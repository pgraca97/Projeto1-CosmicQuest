/*
let users = [
    {
      "username": "paulo",
      "email": "paulo@gmail.com",
      "password": "paulo",
      "characterColor": {
        "src": "/assets/img/Characters/User/Salmon/Chara_Astronaut12_FullBody_Run_4Dir_6x4.png"
      },
      "gameSessions": [
        {
          "roomOnePoints": 30,
          "roomTwoPoints": 40,
          "celestialBodies": [
            {
              "planet": "Sun",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ],
                "puzzles": [
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Meteor Showers",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  },
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Mars",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ]
              }
            },
            {
              "planet": "Venus",
              "challenges": {
                "puzzles": [
                  {
                    "isAnsweredCorrectly": true
                  }
                ]
              }
            }
          ]
        },

      ],
      "settings": {
        "sound": false,
        "fxSound": true,
        "subtitles": true
      },
      "isAdmin": false,
    },
    {
      "username": "user3",
      "email": "paulo@gmail.com",
      "password": "paulo",
      "characterColor": {
        "src": "/assets/img/Characters/User/Salmon/Chara_Astronaut12_FullBody_Run_4Dir_6x4.png"
      },
      "gameSessions": [
        {
          "roomOnePoints": 30,
          "roomTwoPoints": 40,
          "celestialBodies": [
            {
              "planet": "Sun",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ],
                "puzzles": [
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Meteor Showers",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  },
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Mars",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ]
              }
            },
            {
              "planet": "Venus",
              "challenges": {
                "puzzles": [
                  {
                    "isAnsweredCorrectly": true
                  }
                ]
              }
            }
          ]
        },

      ],
      "settings": {
        "sound": false,
        "fxSound": true,
        "subtitles": true
      },
      "isAdmin": false,
      "isBlocked": true,
    },
    {
      "username": "user4",
      "email": "paulo@gmail.com",
      "password": "paulo",
      "characterColor": {
        "src": "/assets/img/Characters/User/Salmon/Chara_Astronaut12_FullBody_Run_4Dir_6x4.png"
      },
      "gameSessions": [
        {
          "roomOnePoints": 30,
          "roomTwoPoints": 40,
          "celestialBodies": [
            {
              "planet": "Sun",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ],
                "puzzles": [
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Meteor Showers",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  },
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Mars",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ]
              }
            },
            {
              "planet": "Venus",
              "challenges": {
                "puzzles": [
                  {
                    "isAnsweredCorrectly": true
                  }
                ]
              }
            }
          ]
        },

      ],
      "settings": {
        "sound": false,
        "fxSound": true,
        "subtitles": true
      },
      "isAdmin": false,
    },
  
  
];*/
import * as User from "/js/Model/User.js";
let users = [
    {
      "username": "paulo",
      "email": "paulo@gmail.com",
      "password": "paulo",
      "characterColor": {
        "src": "/assets/img/Characters/User/Salmon/Chara_Astronaut12_FullBody_Run_4Dir_6x4.png"
      },
      "gameSessions": [
        {
          "roomOnePoints": 30,
          "roomTwoPoints": 40,
          "celestialBodies": [
            {
              "planet": "Sun",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ],
                "puzzles": [
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Meteor Showers",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  },
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Mars",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ]
              }
            },
            {
              "planet": "Venus",
              "challenges": {
                "puzzles": [
                  {
                    "isAnsweredCorrectly": true
                  }
                ]
              }
            }
          ]
        },

      ],
      "settings": {
        "sound": false,
        "fxSound": true,
        "subtitles": true
      },
      "isAdmin": false,
    },
    {
      "username": "user3",
      "email": "paulo@gmail.com",
      "password": "paulo",
      "characterColor": {
        "src": "/assets/img/Characters/User/Salmon/Chara_Astronaut12_FullBody_Run_4Dir_6x4.png"
      },
      "gameSessions": [
        {
          "roomOnePoints": 30,
          "roomTwoPoints": 40,
          "celestialBodies": [
            {
              "planet": "Sun",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ],
                "puzzles": [
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Meteor Showers",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  },
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Mars",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ]
              }
            },
            {
              "planet": "Venus",
              "challenges": {
                "puzzles": [
                  {
                    "isAnsweredCorrectly": true
                  }
                ]
              }
            }
          ]
        },

      ],
      "settings": {
        "sound": false,
        "fxSound": true,
        "subtitles": true
      },
      "isAdmin": false,
      "isBlocked": true,
    },
    {
      "username": "user4",
      "email": "paulo@gmail.com",
      "password": "paulo",
      "characterColor": {
        "src": "/assets/img/Characters/User/Salmon/Chara_Astronaut12_FullBody_Run_4Dir_6x4.png"
      },
      "gameSessions": [
        {
          "roomOnePoints": 30,
          "roomTwoPoints": 40,
          "celestialBodies": [
            {
              "planet": "Sun",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ],
                "puzzles": [
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Meteor Showers",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  },
                  {
                    "isAnsweredCorrectly": false
                  }
                ]
              }
            },
            {
              "planet": "Mars",
              "challenges": {
                "quizzes": [
                  {
                    "isAnsweredCorrectly": true
                  },
                  {
                    "isAnsweredCorrectly": null
                  }
                ]
              }
            },
            {
              "planet": "Venus",
              "challenges": {
                "puzzles": [
                  {
                    "isAnsweredCorrectly": true
                  }
                ]
              }
            }
          ]
        },

      ],
      "settings": {
        "sound": false,
        "fxSound": true,
        "subtitles": true
      },
      "isAdmin": false,
    },
  
  
];

// Get the modal
const modal = document.getElementById("exitModal");
console.log(modal);
// Get the button that opens the modal
const btn = document.getElementById("home-btn");
console.log(btn);
// Get the elements that close the modal
const confirmExit = document.getElementById("btnYes");
const cancelExit = document.getElementById("btnNo");

const modelText = document.querySelector('#modalText');
// When the user clicks the button, open the modal
btn.onclick = function() {
    modal.style.display = "block";
    modelText.innerText = 'Exiting to the home page...';
}

// When the user clicks on "Yes", redirect to index.html
confirmExit.onclick = function() {
    window.location.href = "/index.html";
}

// When the user clicks on "No", close the modal
cancelExit.onclick = function() {
    modal.style.display = "none";
}


function renderGameSessions() {
    // Get the authenticated user
    let user = User.getAuthenticatedUser();

    // Get the 'content' container
    let contentContainer = document.getElementById('content');

    // Clear the previous content
    contentContainer.innerHTML = '';

        // If the user has no game sessions
        if (user.gameSessions.length === 0) {
          // Create a message and a button to start a new game
          let message = document.createElement('p');
          message.innerText = 'Oh explorer, it seems like you have yet to start your journey in cosmic quest. Do you want to create a new game session?';
          contentContainer.appendChild(message);
  
          let newGameButton = document.createElement('button');
          newGameButton.innerText = 'NEW GAME';
          newGameButton.addEventListener('click', function() {
              window.location.href = '/html/new game.html'; // Redirect to the new game page
          });
          contentContainer.appendChild(newGameButton);
  
          return; // Stop execution of the function
      }

    // For each game session in the user's game sessions
    user.gameSessions.forEach((session, index) => {
        // Create a new div to contain the session
        let sessionDiv = document.createElement('div');
        sessionDiv.classList.add('game-session');
        sessionDiv.id = `game-session-${index}`; // Assign a unique id

        // Add the game name
        let gameName = document.createElement('h3');
        gameName.innerText = session.gameName;
        sessionDiv.appendChild(gameName);

        // Add the current room
        let currentRoom = document.createElement('p');
        currentRoom.innerText = `Current Room: ${session.currentRoom}`;
        sessionDiv.appendChild(currentRoom);

        // Add the progress of the current room
        let progress = document.createElement('p');
        progress.innerText = `Progress: ${session[session.currentRoom.toLowerCase() + 'Progress']}%`; // Access either 'roomOneProgress' or 'roomTwoProgress' based on the current room
        sessionDiv.appendChild(progress);

        // Create a 'CONTINUE' button
        let continueButton = document.createElement('button');
        continueButton.innerText = 'CONTINUE';
        continueButton.addEventListener('click', function() {
          console.log('Continue button clicked');
                        // Save the gameName as the active game session
                        localStorage.setItem('activeGameSession', session.gameName);
                        setTimeout(() => {
                          location.href = '../html/rooms.html';
                      }, 3000);
        });
        sessionDiv.appendChild(continueButton);

        // Append the session div to the 'content' container
        contentContainer.appendChild(sessionDiv);
    });
}

// Call the function to render the game sessions
renderGameSessions();

